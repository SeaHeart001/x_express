(function(e){function t(t){for(var n,r,o=t[0],l=t[1],c=t[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={app:0},s=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},2915:function(e,t,a){"use strict";a("bda8")},"3dcc":function(e,t,a){},4508:function(e,t,a){},"4dad":function(e,t,a){},"53d9":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("0fb7"),a("450d");var n=a("f529"),i=a.n(n),s=(a("46a1"),a("e5f2")),r=a.n(s),o=(a("9e1f"),a("6ed5")),l=a.n(o),c=(a("be4f"),a("896a")),u=a.n(c),d=(a("2986"),a("14e9")),p=a.n(d),m=(a("bc1c"),a("4726")),f=a.n(m),h=(a("f92a"),a("d775")),g=a.n(h),v=(a("279e"),a("7d94")),k=a.n(v),w=(a("fa4c"),a("e360")),b=a.n(w),x=(a("acb6"),a("c673")),C=a.n(x),T=(a("e3ea"),a("7bc3")),y=a.n(T),$=(a("fd71"),a("a447")),D=a.n($),L=(a("2f02"),a("fe11")),S=a.n(L),I=(a("ed7b"),a("e1a5")),M=a.n(I),F=(a("bdc7"),a("aa2f")),R=a.n(F),j=(a("de31"),a("c69e")),A=a.n(j),O=(a("a769"),a("5cc3")),P=a.n(O),Y=(a("a673"),a("7b31")),B=a.n(Y),W=(a("adec"),a("3d2d")),E=a.n(W),V=(a("6762"),a("dd3d")),U=a.n(V),q=(a("a586"),a("7464")),z=a.n(q),X=(a("28b2"),a("c7ad")),N=a.n(X),H=(a("b0ee"),a("d180")),G=a.n(H),J=(a("a335"),a("c0bb")),K=a.n(J),Q=(a("186a"),a("301f")),Z=a.n(Q),ee=(a("96dc"),a("9cea")),te=a.n(ee),ae=(a("9c49"),a("6640")),ne=a.n(ae),ie=(a("d2ac"),a("95b0")),se=a.n(ie),re=(a("78a7"),a("33ca")),oe=a.n(re),le=(a("b8e0"),a("a4c4")),ce=a.n(le),ue=(a("e2f3"),a("06f9")),de=a.n(ue),pe=(a("f3e4"),a("9dda")),me=a.n(pe),fe=(a("6b30"),a("c284")),he=a.n(fe),ge=(a("f225"),a("89a9")),ve=a.n(ge),_e=(a("f4f9"),a("c2cc")),ke=a.n(_e),we=(a("7a0f"),a("0f6c")),be=a.n(we),xe=(a("aaa5"),a("a578")),Ce=a.n(xe),Te=(a("b5c2"),a("20cf")),ye=a.n(Te),$e=(a("915d"),a("e04d")),De=a.n($e),Le=(a("5e32"),a("6721")),Se=a.n(Le),Ie=(a("cbb5"),a("8bbc")),Me=a.n(Ie),Fe=(a("e612"),a("dd87")),Re=a.n(Fe),je=(a("075a"),a("72aa")),Ae=a.n(je),Oe=(a("eca7"),a("3787")),Pe=a.n(Oe),Ye=(a("425f"),a("4105")),Be=a.n(Ye),We=(a("b84d"),a("c216")),Ee=a.n(We),Ve=(a("8f24"),a("76b9")),Ue=a.n(Ve),qe=(a("0c67"),a("299c")),ze=a.n(qe),Xe=(a("06f1"),a("6ac9")),Ne=a.n(Xe),He=(a("4ffc"),a("946e")),Ge=a.n(He),Je=(a("d624"),a("3e9c")),Ke=a.n(Je),Qe=(a("826b"),a("c263")),Ze=a.n(Qe),et=(a("5466"),a("ecdf")),tt=a.n(et),at=(a("38a0"),a("ad41")),nt=a.n(at),it=(a("ae26"),a("845f")),st=a.n(it),rt=(a("1951"),a("eedf")),ot=a.n(rt),lt=(a("016f"),a("486c")),ct=a.n(lt),ut=(a("6611"),a("e772")),dt=a.n(ut),pt=(a("1f1a"),a("4e4b")),mt=a.n(pt),ft=(a("e960"),a("b35b")),ht=a.n(ft),gt=(a("d4df"),a("7fc1")),vt=a.n(gt),_t=(a("c526"),a("1599")),kt=a.n(_t),wt=(a("560b"),a("dcdc")),bt=a.n(wt),xt=(a("3c52"),a("0d7b")),Ct=a.n(xt),Tt=(a("fe07"),a("6ac5")),yt=a.n(Tt),$t=(a("b5d8"),a("f494")),Dt=a.n($t),Lt=(a("9d4c"),a("e450")),St=a.n(Lt),It=(a("10cb"),a("f3ad")),Mt=a.n(It),Ft=(a("34db"),a("3803")),Rt=a.n(Ft),jt=(a("8bd8"),a("4cb2")),At=a.n(jt),Ot=(a("ce18"),a("f58e")),Pt=a.n(Ot),Yt=(a("4ca3"),a("443e")),Bt=a.n(Yt),Wt=(a("bd49"),a("18ff")),Et=a.n(Wt),Vt=(a("960d"),a("defb")),Ut=a.n(Vt),qt=(a("cb70"),a("b370")),zt=a.n(qt),Xt=(a("3db2"),a("58b8")),Nt=a.n(Xt),Ht=(a("a7cc"),a("df33")),Gt=a.n(Ht),Jt=(a("672e"),a("101e")),Kt=a.n(Jt),Qt=(a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("2b0e")),Zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},ea=[],ta={name:"App"},aa=ta,na=(a("034f"),a("2877")),ia=Object(na["a"])(aa,Zt,ea,!1,null,null,null),sa=ia.exports,ra=(a("0fae"),a("8c4f")),oa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-wrap"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username","string"===typeof t?t.trim():t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password","string"===typeof t?t.trim():t)},expression:"form.password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("登 录")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onRegister}},[e._v("注 册")])],1)],1)],1)},la=[],ca=(a("ac1f"),a("5319"),a("d3b7"),a("bc3a")),ua=a.n(ca),da=a("4328"),pa=a.n(da),ma=a("2ef0"),fa=a.n(ma),ha="https://test-n48p.onrender.com"/*window.location.origin*/;ha+="/",console.log(ha,Object({NODE_ENV:"production",BASE_URL:""}),"basePath,process");var ga,va=ua.a.create({baseURL:ha});va.interceptors.request.use((function(e){if(console.log(e),e.loading){var t=e.loading;t instanceof Object&&!(t instanceof Array)?ga=Qt["default"].prototype.$loading(t):!0===t&&(ga=Qt["default"].prototype.$loading())}return window.localStorage.getItem("token")&&(e.headers["Authorization"]=window.localStorage.getItem("token")),e}),(function(e){return confirm("请求服务异常request"),Promise.reject(e)})),va.interceptors.response.use((function(e){return fa.a.get(e,"data.data.token","")&&window.localStorage.setItem("token",e.data.data.token),ga&&ga.close(),!0===e.config.configData?e:e.data}),(function(e){return 422===e.response.status?(confirm(fa.a.get(e,"response.data.message","taken无效或已过期")),window.localStorage.clear(),void(window.location.href="./")):(console.log(e.response,"error"),0!==e.response.data.code?(confirm("请求服务异常response"),Promise.reject(e)):void confirm(fa.a.get(e,"response.data.message","请求服务异常response")))})),Qt["default"].prototype.$qs||(Qt["default"].prototype.$qs=function(e){return pa.a.stringify(e)});var _a={success:1,error:0};Qt["default"].prototype.$ajaxMessage||(Qt["default"].prototype.$ajaxMessage=_a);var ka=va,wa={mounted:function(){window.localStorage.removeItem("accessToken")},data:function(){return{form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{onRegister:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;ka({method:"post",url:"/users/register",data:{username:e.form.username,password:e.form.password}}).then((function(t){t.code===e.$ajaxMessage.success?(console.log(t),e.$alert("注册成功，请直接登录")):e.$alert(t.message)})).catch((function(e){console.log(e)}))}))},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;ka({method:"post",url:"/users/login",data:{username:e.form.username,password:e.form.password}}).then((function(t){t.code===e.$ajaxMessage.success?(console.log(t),window.localStorage.setItem("username",e.form.username),e.$router.replace({name:"DailyList"})):e.$alert(t.message)})).catch((function(e){console.log(e)}))}))}}},ba=wa,xa=(a("65aa"),Object(na["a"])(ba,oa,la,!1,null,"767639b7",null)),Ca=xa.exports,Ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"about"},[a("div",{staticClass:"nav-btn-wrapper"},[a("div",{staticClass:"icon-title"},[e._v("Happy Daily Report")]),a("el-button",{class:{is_active:1===e.isActive},on:{click:function(t){return e.toDailyList()}}},[e._v("我的日报")]),a("el-button",{class:{is_active:2===e.isActive},on:{click:function(t){return e.toWriteDaily()}}},[e._v("写日报")]),a("el-button",{staticStyle:{margin:"0 20px 0 auto"},attrs:{type:"text"},on:{click:e.exit}},[e._v("退出")])],1),a("div",{staticClass:"about-router-view"},[a("router-view")],1)])},ya=[],$a={name:"about",data:function(){return{isActive:1}},methods:{toWriteDaily:function(){this.isActive=2,this.$router.push({name:"Axis"})},toDailyList:function(){this.isActive=1,this.$router.push({name:"DailyList"})},exit:function(){this.$router.push({name:"login"})}}},Da=$a,La=(a("ebc2"),Object(na["a"])(Da,Ta,ya,!1,null,"a89c07e8",null)),Sa=La.exports,Ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"axis-wrapper"},[a("div",{staticClass:"axis-form"},[a("div",{staticClass:"form-item"},[a("div",{staticClass:"label"},[e._v("请选择日期")]),a("el-date-picker",{attrs:{disabled:Boolean(e.searchTaskId),clearable:!1,editable:!1,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.daily,callback:function(t){e.daily=t},expression:"daily"}})],1),a("div",{staticClass:"form-item"},[e.searchTaskId?e._e():a("el-button",{on:{click:e.openAddTask}},[e._v("添加任务")]),a("el-button",{on:{click:e.openTaskDetail}},[e._v("日报详情")]),e.searchTaskId?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.saveTask}},[e._v("保存")])],1)]),a("div",{staticClass:"axis-content",class:{"axis-detail":e.searchTaskId}},[a("Axis",{ref:"axisComponent",attrs:{daily:e.daily,searchTaskId:e.searchTaskId},on:{"update:daily":function(t){e.daily=t}}})],1),a("el-dialog",{attrs:{align:"left","show-close":!1,"close-on-click-modal":!1,title:"添加任务",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"product"}},[a("el-input",{attrs:{placeholder:"给任务起个名字"},model:{value:e.ruleForm.product,callback:function(t){e.$set(e.ruleForm,"product",t)},expression:"ruleForm.product"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"任务具体做了些啥？"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1),a("el-form-item",{attrs:{label:"开始时间",prop:"pre_package_time"}},[a("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"09:00",step:"00:30",end:"18:00",maxTime:e.ruleForm.pre_release_time},placeholder:"选择开始时间"},model:{value:e.ruleForm.pre_package_time,callback:function(t){e.$set(e.ruleForm,"pre_package_time",t)},expression:"ruleForm.pre_package_time"}})],1),a("el-form-item",{attrs:{label:"结束时间",prop:"pre_release_time"}},[a("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"09:00",step:"00:30",end:"18:00",minTime:e.ruleForm.pre_package_time},placeholder:"选择结束时间"},model:{value:e.ruleForm.pre_release_time,callback:function(t){e.$set(e.ruleForm,"pre_release_time",t)},expression:"ruleForm.pre_release_time"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveForm()}}},[e._v("确 定")])],1)],1)],1)},Ma=[],Fa=function(e,t){t=t||"YYYY-MM-DD hh:mm:ss";var a=new Date(e).getFullYear(),n=new Date(e).getMonth()+1>9?new Date(e).getMonth()+1:"0"+(new Date(e).getMonth()+1),i=new Date(e).getDate()>9?new Date(e).getDate():"0"+new Date(e).getDate(),s=new Date(e).getHours()>9?new Date(e).getHours():"0"+new Date(e).getHours(),r=new Date(e).getMinutes()>9?new Date(e).getMinutes():"0"+new Date(e).getMinutes(),o=new Date(e).getSeconds()>9?new Date(e).getSeconds():"0"+new Date(e).getSeconds(),l=t.replace("YYYY",a).replace("MM",n).replace("DD",i).replace("hh",s).replace("mm",r).replace("ss",o);return l},Ra=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"lineComponent",staticStyle:{width:"100%",position:"relative"},on:{mouseup:e.udown,mousedown:function(t){return e.showSplitLine(t)},mousemove:function(t){return e.moveSplitLine(t)},mouseleave:e.udown}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.splitLineShow,expression:"splitLineShow"}],staticClass:"split-line",attrs:{name:"split-line"}}),e._m(0),e.lineComponentWidth?a("div",{staticClass:"line-wrap-all-y",attrs:{name:"mouse-event-div"},on:{mousedown:function(t){return e.mdown(t)}}},e._l(e.chartsdata,(function(t,n){return a("div",{key:n,staticClass:"line-y-content",class:{active:e.currentTaskIndex===n},on:{click:function(a){return e.selectCurrentTask(t,n)},contextmenu:function(a){return a.preventDefault(),e.editRowTask(a,t,n)}}},[a("div",{staticClass:"line-y"},[a("div",{staticClass:"line-product"},[e._v(" "+e._s(t.product)+" ")])]),e._l(t.list,(function(i,s){return a("div",{key:n+"_"+s,staticClass:"content",style:e.lineContentStyle(i),on:{mousedown:function(t){return e.selectCurrentIndex(n,s)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.currentItemIndex===n+"_"+s,expression:"currentItemIndex === index1 + '_' + index2"}],staticClass:"left",attrs:{name:"mouse-event-target"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),function(){}.apply(null,arguments)},mousedown:function(t){return e.dirEleClick(t,i,n,s,-1)}}}),a("div",{staticClass:"time-line",class:{even:s%2==1},on:{contextmenu:[function(a){return a.preventDefault(),e.editLine(a,t,i)},function(e){return e.preventDefault(),e.stopPropagation(),function(){}.apply(null,arguments)}],mouseup:e.udown,mousedown:function(t){return e.moveContent(t,i,n,s)}}},[a("div",{staticClass:"line-remark"},[e._v(e._s(i.remark))]),a("div",{staticClass:"start-time"},[e._v(" "+e._s(i.pre_package_time.slice(10,16))+" ")]),a("div",{staticClass:"end-time"},[e._v(" "+e._s(i.pre_release_time.slice(10,16))+" ")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.currentItemIndex===n+"_"+s,expression:"currentItemIndex === index1 + '_' + index2"}],staticClass:"right",attrs:{name:"mouse-event-target"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),function(){}.apply(null,arguments)},mousedown:function(t){return e.dirEleClick(t,i,n,s,1)}}})])}))],2)})),0):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.editTaskRowShow,expression:"editTaskRowShow"}],staticClass:"edit-line-poppover",style:{top:e.contextmenuTop+5+"px",left:e.contextmenuLeft+5+"px"}},[a("el-link",{attrs:{type:"primary"},on:{click:e.addTaskLine}},[e._v("增加进度")]),a("br"),a("el-link",{attrs:{type:"primary"},on:{click:e.removeTaskRow}},[e._v("删除任务")]),a("br")],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.editLineShow,expression:"editLineShow"}],staticClass:"edit-line-poppover",style:{top:e.contextmenuTop+5+"px",left:e.contextmenuLeft+5+"px"}},[a("el-link",{attrs:{type:"primary"},on:{click:e.removeTaskLine}},[e._v("删除进度")]),a("br")],1),a("daily-task-detail",{ref:"DailyTaskDetail",attrs:{daily:e.daily,chartsdata:e.chartsdata}}),a("add-time-line-remark",{ref:"AddTimeLineRemark",on:{addLineToCurrentTask:e.addLineToCurrentTask}})],1)},ja=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"line-wrap-all-x"},[a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("09:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("10:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("11:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("12:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("13:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("14:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("15:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("16:00")])])]),a("div",{staticClass:"line-x-content"},[a("div",{staticClass:"line-x"},[a("span",[e._v("17:00")])])])])}],Aa=(a("159b"),a("4de4"),a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"daily-task-detail-wrapper",attrs:{align:"left",title:"日报详情",visible:e.dialogVisible,"append-to-body":!0,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"date-title"},[e._v(e._s(e.daily))]),a("div",{staticClass:"task-content-wrapper"},e._l(e.chartsdata,(function(t,n){return a("div",{key:n,staticClass:"content"},[a("div",{staticClass:"task-product"},[e._v(e._s(n+1)+". "+e._s(t.product))]),e._l(t.list,(function(t,i){return a("div",{key:n+"-"+i,staticClass:"task-time-remark"},[a("span",[e._v(e._s(t.pre_package_time.slice(10,16))+" - "+e._s(t.pre_release_time.slice(10,16)))]),e._v("   "),a("span",[e._v(e._s(t.remark))])])}))],2)})),0)])}),Oa=[],Pa={name:"DailyTaskDetail",props:{daily:String,chartsdata:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1}},methods:{open:function(){this.dialogVisible=!0},handleClose:function(e){this.dialogVisible=!1,e instanceof Function&&e()}}},Ya=Pa,Ba=(a("2915"),Object(na["a"])(Ya,Aa,Oa,!1,null,null,null)),Wa=Ba.exports,Ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{align:"left","show-close":!1,"close-on-click-modal":!1,title:"进度描述",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"描述",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"继续此任务具体做了啥？"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveForm()}}},[e._v("确 定")])],1)],1)},Va=[],Ua={name:"addTimeLineRemark",props:{daily:{type:String,default:Fa((new Date).getTime(),"YYYY-MM-DD")}},data:function(){return{ruleForm:{remark:""},pre_package_time:"",pre_release_time:"",dialogVisible:!1,rules:{remark:[{required:!0,message:"请输入任务描述",trigger:"blur"}]}}},methods:{show:function(e){console.log(e),this.pre_package_time=e[0],this.pre_release_time=e[1],this.dialogVisible=!0},saveForm:function(){var e=this,t={};this.$refs.ruleForm.validate((function(a){if(!a)return console.log("error submit!!"),!1;console.log(e.ruleForm),t.pre_package_time=Fa(e.pre_package_time),t.pre_release_time=Fa(e.pre_release_time),t.remark=e.ruleForm.remark,console.log(t),e.$emit("addLineToCurrentTask",t),e.handleClose()}))},handleClose:function(e){this.dialogVisible=!1,this.$refs.ruleForm.resetFields(),e&&e()}}},qa=Ua,za=Object(na["a"])(qa,Ea,Va,!1,null,null,null),Xa=za.exports,Na=324e5,Ha=6e4,Ga={name:"hello",props:{daily:{type:String,default:Fa((new Date).getTime(),"YYYY-MM-DD")}},components:{DailyTaskDetail:Wa,AddTimeLineRemark:Xa},watch:{daily:function(e){var t=this;if(0!==this.chartsdata.length)for(var a=/(\d{4})-(\d{2})-(\d{2})/,n=0;n<this.chartsdata.length;n++){var i=this.chartsdata[n].list;i.forEach((function(e){e.pre_package_time=e.pre_package_time.replace(a,t.daily),e.pre_release_time=e.pre_release_time.replace(a,t.daily)}))}},$route:{deep:!0,handler:function(e,t){var a=this;this.chartsdata=[],this.$emit("update:daily",Fa((new Date).getTime(),"YYYY-MM-DD")),console.log(e,t);var n=this.$route.params.id;n&&ka({method:"get",url:"/report/task/".concat(n)}).then((function(e){e.code===a.$ajaxMessage.success?(a.chartsdata=e.data.tasks,a.$emit("update:daily",e.data.reportOfTimeString)):a.$alert(e.message)})).catch((function(e){console.log(e)}))}}},data:function(){return{elePosX:0,lineComponentLeft:0,lineComponentWidth:0,currentItemIndex:0,rowItemData:null,index_1:0,index_2:0,directive:0,exTime:18e5,chartsdata:[],currentTask:{},currentTaskIndex:-1,contextmenuTop:0,contextmenuLeft:0,editTaskRowShow:!1,currentSelectTimeList:[],addLineToIndex:0,editLineShow:!1,splitLineShow:!1}},mounted:function(){var e=this;this.lineComponentWidth=this.$refs.lineComponent.offsetWidth,setTimeout((function(){e.lineComponentWidth=e.$refs.lineComponent.offsetWidth}),300),window.onresize=function(){e.lineComponentWidth=e.$refs.lineComponent.offsetWidth},console.log(this.$route.params);var t=this.$route.params.id;t&&ka({method:"get",url:"/report/task/".concat(t)}).then((function(t){t.code===e.$ajaxMessage.success?(e.chartsdata=t.data.tasks,e.$emit("update:daily",t.data.reportOfTimeString)):e.$alert(t.message)})).catch((function(e){console.log(e)}))},computed:{ableSelectTimeList:function(){var e=this.currentSelectTimeList.filter((function(e,t){return t%2==0}));return e}},methods:{showSplitLine:function(e){console.log(e),3===e.which&&e.target.className.indexOf("time-line")<0&&(this.splitLineShow=!0,this.editTaskRowShow=!1,this.editLineShow=!1)},moveSplitLine:function(e){this.lineComponentLeft=this.$refs.lineComponent.getBoundingClientRect().left,document.querySelector("[name='split-line']").style.left=e.clientX-this.lineComponentLeft+"px"},saveTask:function(){var e=this;0!==this.chartsdata.length?this.$confirm('请确认填写无误后点击"确定"按钮保存?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ka({method:"post",url:"/report/add",data:e.chartsdata}).then((function(t){t.code===e.$ajaxMessage.success?e.$router.replace({name:"DailyList"}):e.$alert(t.message)}))})).catch((function(){e.$message.info("已取消")})):this.$message.warning("请添加任务")},openTaskDetail:function(){this.chartsdata.length>0?this.$refs.DailyTaskDetail.open():this.$message.warning("请添加任务")},selectCurrentTask:function(e,t){this.currentTask=e,this.currentTaskIndex=t,this.editTaskRowShow=!1,this.editLineShow=!1},addTask:function(e){var t=this;this.chartsdata.push(e),setTimeout((function(){t.lineComponentWidth=t.$refs.lineComponent.offsetWidth}),300)},editRowTask:function(e,t,a){this.lineComponentLeft=this.$refs.lineComponent.getBoundingClientRect().left,this.currentTask=t,this.currentTaskIndex=a,this.contextmenuTop=e.clientY-this.$refs.lineComponent.getBoundingClientRect().top,this.contextmenuLeft=e.clientX-this.lineComponentLeft,this.editTaskRowShow=!0,this.editLineShow=!1},removeTaskRow:function(){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.editTaskRowShow=!1,e.chartsdata.splice(e.currentTaskIndex,1)})).catch((function(){e.$message.info("已取消"),e.editTaskRowShow=!1}))},addTaskLine:function(){var e=[];this.currentSelectTimeList=[],e.push(this.daily+" 09:00:00");for(var t=0;t<this.currentTask.list.length;t++)e.push(this.currentTask.list[t].pre_package_time),e.push(this.currentTask.list[t].pre_release_time);e.push(this.daily+" 18:00:00");for(var a=0;a<e.length-1;a++)this.currentSelectTimeList.push([e[a],e[a+1]]);this.editTaskRowShow=!1;var n=Math.floor(this.contextmenuLeft/this.lineComponentWidth*Na)+new Date(this.daily+" 09:00:00").getTime();console.log(n),this.addTaskLimit(n)},addTaskLimit:function(e){console.log(this.ableSelectTimeList);for(var t=[],a=0;a<this.ableSelectTimeList.length;a++){var n=new Date(this.ableSelectTimeList[a][0]).getTime(),i=new Date(this.ableSelectTimeList[a][1]).getTime();if(e>=n&&e+this.exTime<=i){console.log(11111),this.addLineToIndex=a,t[0]=e,t[1]=e+this.exTime;break}}t.length?this.$refs.AddTimeLineRemark.show(t):this.$message.error("请合理安排时间")},addLineToCurrentTask:function(e){console.log(this.addLineToIndex),this.currentTask.list.splice(this.addLineToIndex,0,e)},editLine:function(e,t,a){this.lineComponentLeft=this.$refs.lineComponent.getBoundingClientRect().left,this.editLineShow=!0,this.contextmenuTop=e.clientY-this.$refs.lineComponent.getBoundingClientRect().top,this.contextmenuLeft=e.clientX-this.lineComponentLeft,this.currentTask=t},removeTaskLine:function(){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.currentTask.list.splice(e.index_2,1),e.editLineShow=!1})).catch((function(){e.$message.info("已取消"),e.editLineShow=!1}))},selectCurrentIndex:function(e,t){this.currentItemIndex=e+"_"+t,this.index_1=e,this.index_2=t,this.editTaskRowShow=!1},lineContentStyle:function(e){var t=Math.floor((new Date(e.pre_release_time)-new Date(e.pre_package_time))*this.lineComponentWidth/Na)+1+"px",a=Math.floor((new Date(e.pre_package_time)-new Date(this.daily+" 09:00:00"))*this.lineComponentWidth/Na)+"px";return{width:t,left:a}},computedTime:function(e){var t=e.clientX-this.elePosX,a=Math.floor(t/this.lineComponentWidth*Na);return a},udown:function(){this.splitLineShow=!1,document.onmousemove=null},mdown:function(e){var t=this;if(1===e.which&&"mouse-event-target"===e.target.getAttribute("name")){var a=this.chartsdata[this.index_1].list[this.index_2],n=new Date(a.pre_package_time).getTime(),i=new Date(a.pre_release_time).getTime();document.onmousemove=function(e){t.$nextTick((function(){var s=t.computedTime(e),r=t.compareTimeLint();t.directive<0?n+s>=r.lint1+Ha&&n+s<=r.lint2-Ha?a.pre_package_time=Fa(n+s):n+s<r.lint1+Ha?a.pre_package_time=Fa(r.lint1):n+s>r.lint2-Ha?a.pre_package_time=Fa(r.lint2):a.pre_package_time=a.pre_package_time:i+s>=r.lint2+Ha&&i+s<=r.lint1-Ha?a.pre_release_time=Fa(i+s):i+s<r.lint2+Ha?a.pre_release_time=Fa(r.lint2):i+s>r.lint1-Ha?a.pre_release_time=Fa(r.lint1):a.pre_release_time=a.pre_release_time}))}}},compareTimeLint:function(){var e=0,t=0,a=this.chartsdata[this.index_1].list,n=this.index_2+this.directive,i=this.chartsdata[this.index_1].list.length-1,s=this.exTime;return this.directive<0?(t=new Date(a[this.index_2].pre_release_time).getTime()-s,e=n<0?new Date(this.daily+" 09:00:00").getTime():new Date(a[n].pre_release_time).getTime()):(t=new Date(a[this.index_2].pre_package_time).getTime()+s,e=n>i?new Date(this.daily+" 18:00:00").getTime():new Date(a[n].pre_package_time).getTime()),{lint1:e,lint2:t}},dirEleClick:function(e,t,a,n,i){1===e.which&&(console.log(e),e.preventDefault(),console.log(e,t,a,n,i),this.lineComponentLeft=this.$refs.lineComponent.getBoundingClientRect().left,this.lineComponentWidth=this.$refs.lineComponent.offsetWidth,this.rowItemData=t,this.index_1=a,this.index_2=n,this.directive=i,this.elePosX=e.clientX)},moveContent:function(e,t,a,n){var i=this;if(1===e.which){e.preventDefault(),this.lineComponentLeft=this.$refs.lineComponent.getBoundingClientRect().left,this.lineComponentWidth=this.$refs.lineComponent.offsetWidth,this.rowItemData=t,this.index_1=a,this.index_2=n;var s=this.chartsdata[this.index_1].list,r=this.chartsdata[this.index_1].list.length-1,o=n-1,l=0,c=n+1,u=0,d=this.chartsdata[this.index_1].list[this.index_2],p=new Date(d.pre_package_time).getTime(),m=new Date(d.pre_release_time).getTime();l=o<0?new Date(this.daily+" 09:00:00").getTime():new Date(s[o].pre_release_time).getTime(),u=c>r?new Date(this.daily+" 18:00:00").getTime():new Date(s[c].pre_package_time).getTime();var f=e.clientX;document.onmousemove=function(e){i.$nextTick((function(){var t=Math.floor((e.clientX-f)/i.lineComponentWidth*Na);d.pre_package_time=Fa(p+t),d.pre_release_time=Fa(m+t),t>0&&m+t>u-Ha&&(d.pre_package_time=Fa(u-(m-p)),d.pre_release_time=Fa(u)),t<0&&p+t<l+Ha&&(d.pre_package_time=Fa(l),d.pre_release_time=Fa(l+(m-p)))}))}}}}},Ja=Ga,Ka=(a("66bb"),Object(na["a"])(Ja,Ra,ja,!1,null,null,null)),Qa=Ka.exports,Za={name:"AxisIndex",components:{Axis:Qa},data:function(){return{searchTaskId:"",daily:Fa((new Date).getTime(),"YYYY-MM-DD"),ruleForm:{product:"",pre_package_time:"",pre_release_time:"",remark:""},dialogVisible:!1,rules:{product:[{required:!0,message:"请输入任务名称",trigger:"blur"}],remark:[{required:!0,message:"请输入任务描述",trigger:"blur"}],pre_package_time:[{required:!0,message:"请选择开始时间",trigger:"blur"}],pre_release_time:[{required:!0,message:"请选择结束时间",trigger:"blur"}]}}},watch:{$route:{deep:!0,handler:function(e,t){console.log(e,t),this.searchTaskId=this.$route.params.id}}},mounted:function(){this.searchTaskId=this.$route.params.id},methods:{saveTask:function(){this.$refs.axisComponent.saveTask()},openAddTask:function(){this.dialogVisible=!0},openTaskDetail:function(){this.$refs.axisComponent.openTaskDetail()},saveForm:function(){var e=this,t={product:this.ruleForm.product,list:[{pre_package_time:this.daily+" "+this.ruleForm.pre_package_time+":00",pre_release_time:this.daily+" "+this.ruleForm.pre_release_time+":00",remark:this.ruleForm.remark}]};this.$refs.ruleForm.validate((function(a){if(!a)return console.log("error submit!!"),!1;e.$refs.axisComponent.addTask(t),e.handleClose()})),console.log(t)},handleClose:function(e){this.dialogVisible=!1,this.$refs.ruleForm.resetFields(),e&&e()}}},en=Za,tn=(a("c5b7"),Object(na["a"])(en,Ia,Ma,!1,null,null,null)),an=tn.exports,nn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"daily-list-wrapper"},[e.userList.length?a("div",{staticClass:"person-list"},[a("el-scrollbar",{staticClass:"scrollbar-y"},e._l(e.userList,(function(t){return a("div",{key:t._id,staticClass:"person-item",class:{active:t._id===e.activeUserId},on:{click:function(a){return e.clickUser(t)}}},[a("div",{staticClass:"el-icon-user-solid"}),a("div",{staticClass:"username"},[e._v(e._s(t.username))])])})),0)],1):e._e(),a("div",{staticClass:"daily-list"},[e._m(0),a("el-scrollbar",{staticClass:"scrollbar-y daily-detail-list-wrapper"},e._l(e.taskList,(function(t){return a("div",{key:t._id,staticClass:"daily-item",on:{click:function(a){return e.toTaskDetail(t._id)}}},[a("div",{staticClass:"week_1"},[e._v(e._s(t.createWeek))]),a("div",{staticClass:"el-icon-date"},[e._v("   "+e._s(t.reportOfTimeString)+" "+e._s(t.dayOfTheWeekString)+" ")]),a("el-button",{staticClass:"delete-btn",attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.deleteTask(t)}}},[e._v("删除")])],1)})),0),a("div",{staticClass:"pager"},[a("el-pagination",{attrs:{total:e.total,layout:"prev, pager, next","page-size":e.size,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.handleCurrentChange}})],1)],1)])},sn=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("i",{staticClass:"el-icon-document"}),e._v("日报列表")])}],rn={name:"DailyList",data:function(){return{taskList:[],userList:[],page:1,size:8,total:0,activeUserId:-1}},mounted:function(){this.initMounted()},methods:{initMounted:function(){var e=window.localStorage.getItem("username");"root"!==e?this.getReprotList():(this.getAllUser())},handleCurrentChange:function(e){console.log(e),this.getReprotList()},toTaskDetail:function(e){this.$router.push({path:"Axis/".concat(e)})},deleteTask:function(e){var t=this;this.$confirm("确定删除此条日报吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ka({method:"delete",url:"/report/task/".concat(e._id)}).then((function(e){e.code===t.$ajaxMessage.success?(console.log(e),t.page=1,t.initMounted()):t.$alert(e.message)}))})).catch((function(){t.$message.info("已取消")}))},getReprotList:function(){var e=this;ka({loading:!0,method:"get",url:"/report/list",params:{page:this.page,size:this.size}}).then((function(t){t.code===e.$ajaxMessage.success?(console.log(t),e.taskList=t.data.data,e.total=t.data.total):e.$alert(t.message)}))},getAllUser:function(){var e=this;ka({loading:!0,method:"get",url:"/users/list"}).then((function(t){t.code===e.$ajaxMessage.success?(console.log(t),e.userList=t.data):e.$alert(t.message)}))},clickUser:function(e){var t=this;this.page=1,this.activeUserId=_.get(e,"_id","")||this.activeUserId,ka({loading:!0,method:"get",url:"/report/list/".concat(this.activeUserId),params:{page:this.page,size:this.size}}).then((function(e){e.code===t.$ajaxMessage.success?(console.log(e),t.taskList=e.data.data,t.total=e.data.total):t.$alert(e.message)}))}}},on=rn,ln=(a("947c"),Object(na["a"])(on,nn,sn,!1,null,"49d5fca4",null)),cn=ln.exports;Qt["default"].use(ra["a"]);var un=ra["a"].prototype.push;ra["a"].prototype.push=function(e){return un.call(this,e).catch((function(e){return e}))};var dn=new ra["a"]({routes:[{path:"/",redirect:"/login"},{name:"login",path:"/login",component:Ca},{name:"about",path:"/about",component:Sa,children:[{name:"Axis",path:"Axis",component:an},{name:"AxisDetial",path:"Axis/:id",component:an},{name:"DailyList",path:"DailyList",component:cn}]}]}),pn={Pagination:Kt.a,Dialog:Gt.a,Autocomplete:Nt.a,Dropdown:zt.a,DropdownMenu:Ut.a,DropdownItem:Et.a,Menu:Bt.a,Submenu:Pt.a,MenuItem:At.a,MenuItemGroup:Rt.a,Input:Mt.a,InputNumber:St.a,Radio:Dt.a,RadioGroup:yt.a,RadioButton:Ct.a,Checkbox:bt.a,CheckboxButton:kt.a,CheckboxGroup:vt.a,Switch:ht.a,Select:mt.a,Option:dt.a,OptionGroup:ct.a,Button:ot.a,ButtonGroup:st.a,Table:nt.a,TableColumn:tt.a,DatePicker:Ze.a,TimeSelect:Ke.a,TimePicker:Ge.a,Popover:Ne.a,Tooltip:ze.a,Breadcrumb:Ue.a,BreadcrumbItem:Ee.a,Form:Be.a,FormItem:Pe.a,Tabs:Ae.a,TabPane:Re.a,Tag:Me.a,Tree:Se.a,Alert:De.a,Slider:ye.a,Icon:Ce.a,Row:be.a,Col:ke.a,Upload:ve.a,Progress:he.a,Spinner:me.a,Badge:de.a,Card:ce.a,Rate:oe.a,Steps:se.a,Step:ne.a,Carousel:te.a,CarouselItem:Z.a,Collapse:K.a,CollapseItem:G.a,Cascader:N.a,ColorPicker:z.a,Transfer:U.a,Container:E.a,Header:B.a,Aside:P.a,Main:A.a,Footer:R.a,Timeline:M.a,TimelineItem:S.a,Link:D.a,Divider:y.a,Image:C.a,Calendar:b.a,Backtop:k.a,PageHeader:g.a,CascaderPanel:f.a,Scrollbar:p.a};for(var mn in pn)Qt["default"].use(pn[mn]);Qt["default"].prototype.$loading=u.a.service,Qt["default"].prototype.$msgbox=l.a,Qt["default"].prototype.$alert=l.a.alert,Qt["default"].prototype.$confirm=l.a.confirm,Qt["default"].prototype.$prompt=l.a.prompt,Qt["default"].prototype.$notify=r.a,Qt["default"].prototype.$message=i.a,Qt["default"].config.productionTip=!1,new Qt["default"]({render:function(e){return e(sa)},router:dn}).$mount("#app")},"5a81":function(e,t,a){},"65aa":function(e,t,a){"use strict";a("4dad")},"66bb":function(e,t,a){"use strict";a("4508")},"85ec":function(e,t,a){},"947c":function(e,t,a){"use strict";a("53d9")},bda8:function(e,t,a){},c5b7:function(e,t,a){"use strict";a("5a81")},ebc2:function(e,t,a){"use strict";a("3dcc")}});
